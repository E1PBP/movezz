{% extends "base.html" %}
{% load static currency %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-[848px_1fr] gap-8">

    <!-- display image -->
    <section>
        <div class="w-[848px] max-w-full overflow-hidden rounded-2xl">
            {% if images and images.0.image %}
            <img src="{{ images.0.image.url }}" alt="{{ listing.title }}" class="w-full h-[915px] object-cover" />
            {% else %}
            <img src="{{ listing.image_url }}" alt="{{ listing.title }}" class="w-full h-[915px] object-cover" />
            {% endif %}
        </div>
    </section>

    <!-- product information -->
    <aside class="flex flex-col">
        <h1 class="font-normal text-[32px] leading-[36px] tracking-normal">
            {{ listing.title }}
        </h1>

        <p class="mt-2 font-semibold text-[24px] leading-[32px]">
            {{ listing.price|rupiah }}
        </p>

        {# STACKED condition chip (Brand New / Used) ABOVE location #}
        <div class="mt-3 flex flex-col gap-2">
            {% if listing.condition %}
            <div class="w-fit px-3 py-1 rounded-full font-semibold text-[14px] leading-[20px]
        {% if listing.condition == 'BRAND_NEW' %}
            bg-lime-400 text-[#3F6212]
        {% else %}
            bg-orange-300 text-[#7C2D12]
        {% endif %}">
                {% if listing.condition == 'BRAND_NEW' %}Brand New{% else %}Used{% endif %}
            </div>
            {% endif %}

            {% if listing.location %}
            <div class="flex items-center gap-1 font-semibold text-[14px] leading-[20px] text-[#404040]">
                <i data-lucide="map-pin" class="w-4 h-4"></i>
                <span>{{ listing.location }}</span>
            </div>
            {% endif %}
        </div>

        <div class="mt-4 flex items-center gap-2">
            <a href="{% url 'message_module:chat_home' %}" class="inline-flex items-center justify-center
               w-[364px] h-[48px] rounded-lg border
               font-normal text-[15px] leading-[20px]
               bg-lime-400 border-lime-400 text-[#3F6212]
               hover:bg-lime-500 hover:border-lime-500 transition-colors">
                Message
            </a>
            <button type="button" class="btn btn-ghost btn-square" aria-label="Share">
                <i data-lucide="share" class="w-5 h-5"></i>
            </button>
        </div>

        <h2 class="mt-6 font-bold text-[16px] leading-[24px] text-[#404040]">Details</h2>
        <div class="mt-2 space-y-4 font-normal text-[14px] leading-[20px] text-base-content/80">
            {% if listing.long_description %}
            {{ listing.long_description|linebreaks }}
            {% else %}
            {% if listing.description %}<p>{{ listing.description }}</p>{% endif %}
            {% endif %}
        </div>
    </aside>
</div>

<script>
    if (window.lucide) { window.lucide.createIcons(); }
</script>
{% endblock %}