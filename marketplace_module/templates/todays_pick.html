{% extends 'base_marketplace.html' %}
{% load static currency %}

{% block marketplace_content %}

<h1 class="text-2xl sm:text-3xl font-semibold tracking-tight mb-6">Today's Pick</h1>

<script id="mp-config" type="application/json">
  {{ page_config_json|safe }}
</script>

<meta name="csrf-token" content="{{ csrf_token }}">

<!-- FILTER BAR -->
<div
  class="flex flex-col sm:flex-row sm:items-center mb-8 bg-white rounded-lg border border-gray-200 p-4 gap-3 sm:gap-4">

  {% if user.is_authenticated %}
  <!-- Create Product -->
  <button id="open-create-modal" type="button"
    class="order-1 btn btn-primary bg-lime-500 border-lime-500 hover:bg-lime-600 hover:border-lime-600 text-white"
    onclick="showListingModal()">
    <i data-lucide="plus" class="w-4 h-4"></i>
    <span class="hidden xs:inline">Create Product</span>
  </button>
  {% endif %}


  <!-- search -->
  <label
    class="order-2 input input-sm sm:input-md input-bordered flex items-center gap-2 w-full sm:w-72 md:w-[28rem] flex-1">
    <svg class="h-[1em] opacity-50 shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" fill="none" stroke="currentColor">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.3-4.3"></path>
      </g>
    </svg>
    <input id="input-search" type="search" class="grow" required placeholder="Search" />
  </label>

  <!-- filter button chip -->
  <div class="order-3 w-full sm:w-auto overflow-x-auto">
    <div class="join whitespace-nowrap">
      <button id="chip-all" type="button"
        class="btn btn-sm join-item text-neutral-900 bg-base-200 border-base-200 hover:bg-base-300 active:bg-base-400">
        All
      </button>
      <button id="chip-new" type="button"
        class="btn btn-sm join-item text-neutral-900 bg-[#A3E635] border-[#A3E635] hover:bg-[#8FD542] active:bg-[#7BC536]">
        Brand New
      </button>
      <button id="chip-used" type="button"
        class="btn btn-sm join-item text-neutral-900 bg-[#FB923C] border-[#FB923C] hover:bg-[#FFA24F] active:bg-[#F78E2D]">
        Used
      </button>
    </div>
  </div>

  {% if user.is_authenticated %}
  <!-- wishlist -->
  <a href="{% url 'marketplace_module:wishlist_page' %}"
    class="order-4 btn bg-[#FFEEF0] border-[#FFEEF0] text-rose-600 hover:bg-[#FFE3E7] hover:border-[#FFE3E7]">
    <i data-lucide="heart" class="w-4 h-4"></i>
    <span class="hidden xs:inline">Wishlist</span>
  </a>
  {% endif %}

  <!-- refresh -->
  <button id="btn-refresh" class="order-5 btn btn-xs sm:btn-sm sm:ml-auto">
    <span class="hidden sm:inline">Refresh</span>
    <i data-lucide="refresh-ccw" class="w-4 h-4 sm:ml-1"></i>
  </button>
</div>

<!-- states -->
<div id="loading" class="bg-base-100 rounded-lg border border-base-200 p-10 text-center hidden">
  <span class="loading loading-spinner loading-md"></span>
  <p class="mt-3 text-base-content/70">Loading listingsâ€¦</p>
</div>
<div id="error" class="bg-base-100 rounded-lg border border-error p-6 text-center hidden">
  <p class="text-error font-semibold">Failed to load data. Please try again.</p>
</div>
<div id="empty" class="bg-base-100 rounded-lg border border-base-200 p-10 text-center hidden">
  <p class="text-base-content/70">No listings found.</p>
</div>

<!-- grid -->
<div id="grid" class="grid grid-cols-1 xs:grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6 px-2 sm:px-0 hidden"></div>


{% endblock %}