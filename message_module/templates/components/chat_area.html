{% if selected_conversation %}
<div
  class="flex items-center justify-between lg:justify-start gap-3 border-b bg-base-100 px-4 py-4 sticky top-0 z-10"
>
  <label for="chat-drawer" class="btn btn-ghost btn-circle lg:hidden">
    <i data-lucide="menu" class="w-5 h-5"></i>
  </label>
  <img
    src="{{ selected_conversation.other_user.profile.avatar.url|default:'/static/img/default-avatar.png' }}"
    class="w-10 h-10 rounded-full object-cover"
    alt="{{ selected_conversation.other_user.username }}"
  />
  <div class="flex-1">
    <h2 class="font-semibold text-lg">
      {{ selected_conversation.other_user.username }}
    </h2>
    <p class="text-xs text-base-content/60">
      @{{ selected_conversation.other_user.username|lower }}
    </p>
  </div>
</div>

<div
  id="chat-messages"
  class="flex-1 overflow-y-auto p-4 space-y-4 bg-base-100"
>
  {% for msg in messages %} {% include "components/message_bubble.html" with msg=msg %}
  {% empty %}
  <div class="flex items-center justify-center h-full">
    <p class="text-base-content/60">No messages yet. Start the conversation!</p>
  </div>
  {% endfor %}
</div>

<div class="border-t bg-base-100 p-4">
  <form id="chat-form" class="flex items-center gap-2">
    {% csrf_token %}
    <input
      type="text"
      id="chat-input"
      name="message"
      placeholder="Start a new message"
      class="input input-bordered flex-1 focus:outline-none focus:ring-2 focus:ring-green-500"
      required
    />
    <button
      type="submit"
      class="btn btn-circle btn-primary bg-green-500 border-green-500 hover:bg-green-600 hover:border-green-600"
    >
      <i data-lucide="send" class="w-5 h-5"></i>
    </button>
  </form>
</div>
{% else %}
<div class="flex-1 flex flex-col items-center justify-center gap-4 p-4">
  <div class="text-center">
    <h2 class="text-2xl font-bold mb-2">Select a message</h2>
    <p class="text-base-content/60 mb-6">
      Choose from your existing conversations or start a new one
    </p>
  </div>
  <label
    for="new-convo-modal"
    class="btn btn-primary bg-green-500 border-green-500 hover:bg-green-600 hover:border-green-600 text-white"
  >
    <i data-lucide="plus" class="w-5 h-5"></i>
    Start A New Conversation
  </label>
</div>
{% endif %}
